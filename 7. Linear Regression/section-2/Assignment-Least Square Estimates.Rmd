---
title: 'Assignment: Least Square Estimates'
author: "Anurag Garg"
date: '`r Sys.Date()`'
output: github_document
---

## Loading Library and Data
```{r}
library(tidyverse)
library(HistData)
data("GaltonFamilies")
set.seed(1983)
galton_heights <- GaltonFamilies %>%
  filter(gender == "male") %>%
  group_by(family) %>%
  sample_n(1) %>%
  ungroup() %>%
  select(father, childHeight) %>%
  rename(son = childHeight)

rss <- function(beta0, beta1){
    resid <- galton_heights$son - (beta0+beta1*galton_heights$father)
    return(sum(resid^2))
}
```

## Question 1

The following code was used in the video to plot RSS with $\beta_o = 25$.

```{r}
beta1 = seq(0, 1, len=nrow(galton_heights))
results <- data.frame(beta1 = beta1,
                      rss = sapply(beta1, rss, beta0 = 25))
results %>% ggplot(aes(beta1, rss)) + geom_line() + 
  geom_line(aes(beta1, rss), col=2)
```

In a model for sons’ heights vs fathers’ heights, what is the least squares estimate (LSE) $\beta_1$ for if we assume is $\hat{\beta_1} = 36$?

```{r}
beta1 = seq(0, 1, len=nrow(galton_heights))
results <- data.frame(beta1 = beta1,
                      rss = sapply(beta1, rss, beta0 = 36))
results %>% ggplot(aes(beta1, rss)) + geom_line() + 
  geom_line(aes(beta1, rss), col=2)
results %>% filter(rss == min(rss)) %>% select(beta1) %>% pull(beta1)
```

## Question 3

Load the Lahman library and filter the Teams data frame to the years 1961-2001. Mutate the dataset to create variables for bases on balls per game, runs per game, and home runs per game, then run a linear model in R predicting the number of runs per game based on both the number of bases on balls per game and the number of home runs per game.

What is the coefficient for bases on balls per game?

```{r}
library(Lahman)
dat <- Teams %>%
    filter(yearID >= 1961 & yearID <= 2001) %>%
    mutate(runs_per_game = R/G, hr_per_game = HR/G, bb_per_game = BB/G) %>%
    select(runs_per_game, hr_per_game, bb_per_game)
head(dat)
```

What is the coefficient for bases on balls per game?

```{r}
lm(runs_per_game ~ hr_per_game + bb_per_game, data = dat)
```

## Question 4
1 point possible (graded)

We run a Monte Carlo simulation where we repeatedly take samples of N = 100 from the Galton heights data and compute the regression slope coefficients for each sample: 

```{r}
B <- 1000
N <- 100
lse <- replicate(B, {
    sample_n(galton_heights, N, replace = TRUE) %>% 
    lm(son ~ father, data = .) %>% .$coef 
})

lse <- data.frame(beta_0 = lse[1,], beta_1 = lse[2,]) 
head(lse)
```

## Question 5

Which R code(s) below would properly plot the predictions and confidence intervals for our linear model of sons’ heights?

```{r}
galton_heights %>% ggplot(aes(father, son)) +
    geom_point() +
    geom_smooth(method = "lm")
```


p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue") +
theme_half_open() +
background_grid()
p + theme(
panel.grid.major = element_line(colour, size, linetype,
lineend, color),
panel.grid.minor = element_line(colour, size, linetype,
lineend, color)
)
p + theme(
panel.grid.major = element_line(colour, size, linetype,
lineend),
panel.grid.minor = element_line(colour, size, linetype,
lineend)
)
p + theme(
panel.grid.major = element_line(color, size, linetype,
lineend),
panel.grid.minor = element_line(color, size, linetype,
lineend)
)
p + theme(
panel.grid.major = element_line(),
panel.grid.minor = element_line()
)
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p + theme(
panel.grid.major = element_line(),
panel.grid.minor = element_line()
)
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p + theme(
panel.background = element_rect(fill = "lightblue",
colour = "lightblue",
size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
panel.grid.minor = element_line(size = 0.25, linetype = 'solid',
colour = "white")
)
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
names(temp_carbon)
temp_carbon %>%
p + geom_line(year, land_anomaly)
temp_carbon %>%
geom_line(year, land_anomaly) + p
p + geom_line(data = temp_carbon, x = year, y = land_anomanly, na.rm = TRUE)
p + geom_line(data = temp_carbon$land_anomaly, na.rm = TRUE)
p + geom_line(x = temp_carbon$land_anomaly, y = temp_carbon$year, na.rm = TRUE)
p1 <- temp_carbon %>%
filter(!is_na(land_anomaly)) %>%
ggplot(aes(year, land_anomaly)) +
geom_line()
p2 <- temp_carbon %>%
filter(!is_na(ocean_anomaly)) %>%
ggplot(aes(year, ocean_anomaly)) +
geom_line()
p1 <- temp_carbon %>%
filter(!is_na(land_anomaly)) %>%
ggplot(aes(year, land_anomaly)) +
geom_line()
p1 <- temp_carbon %>%
ggplot(aes(year, land_anomaly)) +
geom_line()
p2 <- temp_carbon %>%
ggplot(aes(year, ocean_anomaly)) +
geom_line()
p + p1 + p2
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p + p1 + p2
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p1 <- temp_carbon %>%
geom_line(aes(year, land_anomaly))
p2 <- temp_carbon %>%
geom_line(aes(year, ocean_anomaly))
p + p1 + p2
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(year, land_anomanly)) +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(year, temp_anomanly)) +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_line(aes(year, temp_anomanly)) +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_line() +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(land_anomaly) +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(land_anomaly)) +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(land_anomaly), col="red") +
geom_line(aes(ocean_anomaly), col="lightblue") +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(ocean_anomaly), col="lightblue") +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(land_anomaly), col="red") +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly) & !is.na(land_anomaly) & !is_na(ocean_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(land_anomaly), col="red") +
geom_line(aes(ocean_an), col="lightblue") +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p <- temp_carbon %>%
filter(!is.na(temp_anomaly), !is.na(land_anomaly), !is_na(ocean_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(land_anomaly), col="red") +
geom_line(aes(ocean_an), col="lightblue") +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
filter(!is.na(land_anomaly)) %>%
filter(!is.na(ocean_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(land_anomaly), col="red") +
geom_line(aes(ocean_an), col="lightblue") +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
filter(!is.na(land_anomaly)) %>%
filter(!is.na(ocean_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, temp_anomaly)) +
geom_point() +
geom_line(aes(land_anomaly), col="red") +
geom_line(aes(ocean_anomaly), col="lightblue") +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
head(temp_carbon)
p <- temp_carbon %>%
filter(!is.na(land_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year, land_anomaly)) +
geom_point() +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
p <- temp_carbon %>%
filter(!is.na(land_anomaly)) %>%
select(year, land_anomaly) %>%
ggplot(aes(year, land_anomaly)) +
geom_point() +
p
p <- temp_carbon %>%
filter(!is.na(land_anomaly)) %>%
select(year, land_anomaly) %>%
ggplot(aes(year, land_anomaly)) +
geom_point() +
p
p <- temp_carbon %>%
filter(!is.na(land_anomaly)) %>%
select(year, land_anomaly) %>%
ggplot(aes(year, land_anomaly)) +
geom_point()
p
p <- temp_carbon %>%
filter(!is.na(temp_anomaly)) %>%
filter(!is.na(land_anomaly)) %>%
filter(!is.na(ocean_anomaly)) %>%
select(year, temp_anomaly, land_anomaly, ocean_anomaly) %>%
ggplot(aes(year)) +
geom_point(aes(y = temp_anomaly)) +
geom_line(aes(y = land_anomaly), col="red") +
geom_line(aes(y = ocean_anomaly), col="lightblue") +
geom_hline(aes(yintercept = 0), col = "blue") +
ylab("Temperature anomaly (degrees C)") +
ggtitle("Temperature anomaly relative to 20th century mean, 1880-2018") +
geom_text(aes(x = 2000, y = 0.05, label = "20th century mean"), col = "blue")
p
data(historic_co2)
names(greenhouse_gases)
str(greenhouse_gases)
head(greenhouse_gases)
greenhouse_gases %>%
ggplot(aes(year, concentration)) +
geom_line() +
facet_grid(gas~., scales = "free") +
geom_abline(x = 1850) +
ylab("Concentration (ch4/n2o ppb, co2 ppm)") +
ggtitle("Atmospheric greenhouse gas concentration by year, 0-2000")
greenhouse_gases %>%
ggplot(aes(year, concentration)) +
geom_line() +
facet_grid(gas~., scales = "free") +
geom_vline(x = 1850) +
ylab("Concentration (ch4/n2o ppb, co2 ppm)") +
ggtitle("Atmospheric greenhouse gas concentration by year, 0-2000")
greenhouse_gases %>%
ggplot(aes(year, concentration)) +
geom_line() +
facet_grid(gas~., scales = "free") +
geom_vline(xintercept = 1850) +
ylab("Concentration (ch4/n2o ppb, co2 ppm)") +
ggtitle("Atmospheric greenhouse gas concentration by year, 0-2000")
greenhouse_gases %>%
ggplot(aes(year, concentration)) +
geom_line() +
facet_grid(gas~., scales = "free") +
geom_vline(xintercept = 1850, color = "blue") +
ylab("Concentration (ch4/n2o ppb, co2 ppm)") +
ggtitle("Atmospheric greenhouse gas concentration by year, 0-2000")
temp_carbon %>%
ggplot(aes(year, carbon_emissions)) +
geom_line()
temp_carbon %>%
filter(!is.na(carbon_emissions))
ggplot(aes(year, carbon_emissions)) +
geom_line()
temp_carbon %>%
filter(!is.na(carbon_emissions)) %>%
ggplot(aes(year, carbon_emissions)) +
geom_line()
data("historic_co2")
names(historic_co2)
str(historic_co2)
head(historic_co2)
names(historic_co2$source)
unique(historic_co2$source)
co2_time <- historic_co2 %>%
filter(!is.na(co2)) %>%
ggplot(aes(year, co2, color = source())) +
geom_line()
co2_time
geom_line()
co2_time
geom_line()
co2_time
co2_time <- historic_co2 %>%
filter(!is.na(co2)) %>%
ggplot(aes(year, co2, color = source)) +
geom_line()
co2_time
co2_time + xlim(c(-800000, -7500000))
co2_time + xlim(c(-800000, -750000))
co2_time + xlim(c(-800000, -775000))
co2_time + xlim(c(-375000, -330000))
co2_time + xlim(c(-140000, -120000))
co2_time + xlim(c(-3000, 2018))
pnorm(0, mu_s, se_s)
source('~/OneDrive - НИУ Высшая школа экономики/Documents/EdX/3. Probability/Final_assessment-1.R', echo=TRUE)
setwd("~/OneDrive - НИУ Высшая школа экономики/Documents/EdX/3. Probability")
mu <- a * p_male + b * (1 - p)
mu
a <- -150000
b <- 1150
p <- 0.015
mu <- a * p_male + b * (1 - p)
mu
mu * 1000
a <- -150000
b <- 1150
p <- 0.015
mu <- a * p + b * (1 - p)
mu * 1000
se <- abs(b - a) * sqrt(n * p * (1 - p))
se
prob_loss <- pnorm(0, mu, se)
prob_loss
mu <- a * p + b * (1 - p) * 1000
mu
se
prob_loss <- pnorm(0, mu, se)
prob_loss
prob_loss <- pnorm(0, mu / 1000, se / sqrt(n))
prob_loss
# What is the probability of the company losing money?
prob <- pnorm(0, mu, se)
prob_loss
?pnorm
# What is the probability of the company losing money?
prob <- pnorm(0, mu, se*se)
prob_loss
se <- abs(b - a) * sqrt(n * p * (1 - p))
se
# What is the probability of the company losing money?
prob <- pnorm(0, mu, se*se)
prob_loss
sd <- se*se
sd
prob <- pnorm(0, mu, sd)
prob_loss
sd <- se*se / 1000
mu_1 <- mu / 1000
prob <- pnorm(0, mu_1, sd)
prob_loss
sd <- se*se
prob <- pnorm(0, mu, sd)
prob_loss
S <- replicate(10000, {
defaults <- sum(sample(c(a, b), 1000, replace=TRUE, p=c(p, 1-p)))
})
mean(S)
S <- replicate(10000, {
defaults <- sum(sample(c(a, b), 1000, replace=TRUE, p=c(p, 1-p)))
sum(defaults < 0)
})
mean(S)
S
a <- -150000
b <- 1150
p <- 0.015
mu <- a * p + b * (1 - p) * 1000
mu
# Question 3b
# What is the standard error of the expected value of
# the company's profits over 1,000 policies?
se <- abs(b - a) * sqrt(n * p * (1 - p))
se
p_pend <- 0.015
# What is the probability of the company losing money?
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend))
# What is the probability of the company losing money?
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend), replace=TRUE)
mean(samp < 0)
# What is the probability of the company losing money?
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend), replace=TRUE)
mean(samp < 0)
# What is the probability of the company losing money?
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend), replace=TRUE)
mean(samp < 0)
# What is the probability of the company losing money?
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend), replace=TRUE)
mean(samp < 0)
# What is the probability of the company losing money?
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend), replace=TRUE)
mean(samp < 0)
# What is the probability of the company losing money?
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend), replace=TRUE)
mean(samp < 0)
# What is the probability of the company losing money?
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend), replace=TRUE)
mean(samp < 0)
# What is the probability of the company losing money?
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend), replace=TRUE)
mean(samp < 0)
S <- replicate(100000, {
samp <- sample(c(a, b), 1000, p=c(p_pend, 1-p_pend), replace=TRUE)
mean(samp < 0)
})
mean(S)
mu <- a * p_pend + b * (1 - p_pend) * 1000
mu
se <- abs(b - a) * sqrt(n * p_pend * (1 - p_pend))
se
pnorm(0, mu, se)
summary(S)
pnorm(1000000, mu, se)
pnorm(0, mu, se)
pnorm(-1000000, mu, se)
1 - pnorm(0, mu, se)
n <- 1000
# What is the probability of the company losing money?
pnorm(0, n*mu, sqrt(n)*se)
# What is the probability of the company losing money?
pnorm(0, mu, se)
pnorm(-1000000, mu, se)
mu
mu <- a * p_pend + b * (1 - p_pend) * n
mu
# What is the probability of the company losing money?
pnorm(0, mu, se)
# What is the probability of the company losing money?
pnorm(0, mu/1000, se/sqrt(n))

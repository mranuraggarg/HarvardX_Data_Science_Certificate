---
title: "Section 2.3 Quiz"
output: html_notebook
---

## Loading Libraries

```{r, echo=FALSE}
library(tidyverse)
library(dslabs)
library(rvest)
```

## Introduction: Questions 1-3

Load the following web page, which contains information about Major League Baseball payrolls, into R:
\url{https://web.archive.org/web/20181024132313/http://www.stevetheump.com/Payrolls.htm}

```{r}
url = "https://web.archive.org/web/20181024132313/http://www.stevetheump.com/Payrolls.htm"
webpage <- read_html(url)
webpage
```

We learned that tables in html are associated with the table node.  Use the html_nodes() function and the table node type to extract the first table. Store it in an object nodes:

```{r}
nodes <- html_nodes(webpage, "table")
```

The html_nodes() function returns a list of objects of class xml_node. We can see the content of each one using, for example, the html_text() function. You can see the content for an arbitrarily picked component like this:

```{r}
html_text(nodes[[8]])
```

If the content of this object is an html table, we can use the html_table() function to convert it to a data frame:

```{r}
html_table(nodes[[8]])
```

You will analyze the tables from this HTML page over questions 1-3.

## Question 1

Many tables on this page are team payroll or salary information tables - with columns for rank, team, and one or more money values.

Convert the first four tables in nodes to data frames and inspect them.

Note that "parsing errors" and/or "empty tables" still count towards the table index!

Which of the first four nodes are tables of team payroll?

Remember that payroll is information about the total salary on a team.

```{r, echo=FALSE}
tab1 <- html_table(nodes[[1]])
tab2 <- html_table(nodes[[2]])
tab3 <- html_table(nodes[[3]])
tab4 <- html_table(nodes[[4]])
```

Inspecting Tables

```{r, echo=FALSE}
# tab2 is Payroll
tab2
```

```{r, echo=FALSE}
tab3
```

```{r}
# Earnings and salary statistics
tab4
```

## Question 2
For the last 3 components of nodes, which of the following are true?

Check all correct answers.

Checking all last three tables
```{r}
total_length <- length(nodes)
total_length
```

Last three tables are 21, 20, 19

```{r}
# Salary statistics
tab21 <- html_table(nodes[[21]])
tab21
```


```{r}
# Salary statistics
tab20 <- html_table(nodes[[20]])
tab20
```


```{r}
# Salary statistics
tab19 <- html_table(nodes[[19]])
tab19
```

## Question 3

Create a table called tab_1 using entry 10 of nodes. Create a table called tab_2 using entry 19 of nodes.

Note that the column names should be `c("Team", "Payroll", "Average")`. You can see that these column names are actually in the first data row of each table, and that tab_1 has an extra first column No. that should be removed so that the column names for both tables match.

Remove the extra column in tab_1, remove the first row of each dataset, and change the column names for each table to `c("Team", "Payroll", "Average")`. 

```{r}
tab_1 <- html_table(nodes[[10]], header = TRUE)
tab_2 <- html_table(nodes[[19]], header = TRUE)
```

Exploring tab_1 and deleting ``No.

```{r}
tab_1 <- select(tab_1, c("Team", "Payroll", "Average"))
tab_1
```

Exploring tab_2

```{r}
tab_2
```


Use a `full_join()` by the Team to combine these two tables.

How many rows are in the joined data table?

```{r}
full_join_tab <- full_join(x = tab_1, y = tab_2, by = "Team")
dim(full_join_tab)
```


## Introduction: Questions 4 and 5

The Wikipedia page on opinion polling for the Brexit referendum External link, in which the United Kingdom voted to leave the European Union in June 2016, contains several tables. One table contains the results of all polls regarding the referendum over 2016:

Use the rvest library to read the HTML from this Wikipedia page (make sure to copy both lines of the URL):

```{r}
library(rvest)
library(tidyverse)
url <- "https://en.wikipedia.org/w/index.php?title=Opinion_polling_for_the_United_Kingdom_European_Union_membership_referendum&oldid=896735054"
```

# Question 4

Assign tab to be the html nodes of the "table" class.
How many tables are in this Wikipedia page?

```{r}
eu_mem <- read_html(url)
tab <- html_nodes(eu_mem, "table")
length(tab)
```


# Question 5

Inspect the first several html tables using html_table() with the argument fill=TRUE (you can read about this argument in the documentation). Find the first table that has 9 columns with the first column named "Date(s) conducted".
What is the first table number to have 9 columns where the first column is named "Date(s) conducted"?

```{r}
# Reaching to sixth table after checking all previous
html_table(tab[6], header = TRUE, fill = TRUE)
```
